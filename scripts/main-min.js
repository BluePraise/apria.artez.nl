var isTouch="ontouchstart"in document,noTouch=!isTouch,duration=250;function getBreakpoint(){$("#bp").length||$('<div id="bp"/>').appendTo("body");var e=$("#bp").width();return 3==e?"desktop":2==e?"tablet":1==e?"mobile":void 0}function positionColumnLabel(e,t){if($(".column-label").length){if(e)var o=e.find(".column-label");else o=$(".column-label");if(!t)t=$("body").width();o.css("left",t-o.closest(".sidebar-column").outerWidth(!0)-o.width()/2+"px")}}function affixHeight(){if("mobile"!=getBreakpoint()){var e=$("article.main-column .content-wrap"),t=$(".js-affix-scrolling"),o=$(".affix-placeholder");e.height()<t.height()?railHeight=t.height():railHeight=e.height(),o.css("height",railHeight)}}function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function initNewsletter(){$("#newsletter").attr("novalidate",!0).each((function(){var e=$(this),t=e.find('input[name="ne"]'),o=t.prev(),i=e.find('input[type="submit"]'),n=function(e){var t=o.clone();o.before(t),o.remove(),t.text(e).addClass("vaporize").attr("aria-hidden","false")};e.submit((function(s){var a=e.serialize();if(o=t.prev(),s.preventDefault(),validateEmail(t.val())){var l;l={action:"realhero_subscribe",nonce:ajax.ajax_nonce,data:a},$.ajax({method:"POST",url:ajax.url,data:l,beforeSend:function(){t.prop("disabled",!0),i.val("Wait").prop("disabled",!0)},success:function(o){"success"==o.status?e.fadeOut("slow",(function(){e.replaceWith('<p class="appear-nicely dynamic-msg">Thank you!</p>')})):(t.prop("disabled",!1),i.val("Submit").prop("disabled",!1),n(o.msg))}})}else n("Enter valid e-mail address!")}))}))}function filter(){var e=[];for(var t in $(this).toggleClass("checked"),$(".js-filter:checked").each((function(){var t=$(this).val(),o=$(this).data("type");o in e||(e[o]=[]),e[o].push(".search-result.filter-"+o+"-"+t)})),e)e[t]=e[t].join(",");$(".search-results").empty(),$(".search-results-hidden .search-result").removeClass("cloned"),0==$(".js-filter:checked").length&&$(".search-results-hidden").find(".search-result").clone().appendTo($(".search-results")),$(".search-results-hidden .search-result").filter((function(){var t=$(this);for(var o in e){var i=e[o];t.is(i)&&!t.hasClass("cloned")&&(t.clone().appendTo($(".search-results")),t.addClass("cloned"))}}))}function captionWidth(){$(".inline-image").each((function(){var e=$(this),t=e.find("img"),o=e.find("figcaption");o.length&&o.css("width",t.width())}))}function closeOverlayer(){$("#overlay-content").fadeOut(duration),setTimeout((function(){$("html").removeClass("no-scroll overlay-open"),$("#overlay-content").remove()}),duration)}captionWidth(),$((function(){$("html").addClass(isTouch?"is-touch":"no-touch"),FastClick.attach(document.body),balanceText(),$(window).on("resize",(function(){"mobile"!=getBreakpoint()&&positionColumnLabel(),captionWidth(),affixHeight()})).trigger("resize"),$(document).on("click",".js-picture-text-toggle",(function(){$("html").hasClass("text-view")?($("html").removeClass("text-view").addClass("picture-view"),$.cookie("displayMode","picture",{path:"/"})):($("html").removeClass("picture-view").addClass("text-view"),$.cookie("displayMode","text",{path:"/"}))})),$(document).on("click",".js-footnote-up",(function(){var e=$(this),t=$('[data-footnoteanchor="'+e.data("footnotetext")+'"]');t.length&&$("html, body").animate({scrollTop:t.offset().top},500),$(".footnote").removeClass("footnote-highlight")})).on("click",".js-footnote",(function(){var e=$(this),t=$('[data-footnotetext="'+e.data("footnoteanchor")+'"]').closest(".footnote");t.length&&(position=t.offset().top,$("html, body").animate({scrollTop:position},500),t.siblings(".footnote").removeClass("footnote-highlight"),t.addClass("footnote-highlight"))})),$(document).on("click",".js-open-as-overlay",(function(e){if($(e.target).is("a"))var t=$(this).attr("href");else{if(!$(this).closest(".issue-preview, .home-issue").hasClass("clickable-block"))return;t=$(this).data("href")}e.stopPropagation();var o=$("body").width();return $.get(t,(function(e){var t=$("<div/>").append(e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));$("html").addClass("no-scroll overlay-open"),$("#overlay-content").remove();var i=t.find(".main-content"),n=$('<div id="overlay-content"></div>');n.append(i).hide().appendTo("body").fadeIn(duration),n.on("hide",(function(){$("html").removeClass("no-scroll overlay-open"),$(this).fadeOut(duration,(function(){$(this).remove()}))})),n.on("scroll",(function(){$("#overlay-content").scrollTop()>=20?$("html").addClass("issue-header-fixed"):$("html").removeClass("issue-header-fixed")})),initNewsletter(),"mobile"!=getBreakpoint()&&positionColumnLabel(n,o)})),!1})),$(document).on("click",".js-newsletter-close-button",(function(){closeOverlayer()})),$(document).on("click",".js-overlay-close-button",(function(e){var t=document.referrer;$('<a href="'+t+'"></a>').get(0).hostname==location.hostname&&(history.back(1),e.preventDefault())})),$(document).on("mouseenter","header",(function(){$("html").addClass("header-open")})).on("mouseleave","header",(function(){$("html").removeClass("header-open")})),$(window).on("scroll",(function(){var e;$("header").length?("desktop"==getBreakpoint()?(logoPos=70,e=139):"mobile"==getBreakpoint()&&(logoPos=40,e=70),$(window).scrollTop()>=e?$("html").addClass("header-fixed"):$("html").removeClass("header-fixed"),$(window).scrollTop()>=logoPos?$("html").addClass("logo-fixed"):$("html").removeClass("logo-fixed")):$(".issue-header").length&&($(window).scrollTop()>=20?$("html").addClass("issue-header-fixed"):$("html").removeClass("issue-header-fixed"))})),"mobile"!=getBreakpoint()&&($(".js-affix-scrolling").sysAffix({lockedBottom:26}),$(".js-affix-scrolling-issue").sysAffix({lockedTop:95,lockedBottom:26})),$(document).on("click",".js-mobile-menu-button",(function(){$("html").hasClass("mobile-menu-open")||$("html").addClass("mobile-menu-open")})).on("click",".js-mobile-menu-close-button",(function(){$("html").removeClass("mobile-menu-open")})),$(".search-form").length&&$(".search-form .form__input").on("focusin",(function(){$(this).closest("form").find(".form__label").addClass("hide")})),$(".search-result").length&&($('<div class="search-results-hidden" style="display: none;"></div>').appendTo($("body")),$(".search-result").clone().appendTo($(".search-results-hidden"))),$(document).on("click",".js-filter",(function(){filter()})),$(document).on("click",".js-reset-filter",(function(){$(".js-filter").prop("checked",!1),filter()})),$(document).on("click",".js-reset-filter-group",(function(){$(this).closest(".filter__group").find(".js-filter").prop("checked",!1),filter()})),$(document).on("click",".js-opencall-close-button",(function(e){$("#overlay-content").length&&(closeOverlayer(),e.preventDefault())})),$(document).on("click",".js-load-more",(function(){"mobile"==getBreakpoint()&&($(".home-issue").fadeIn(),$(this).addClass("hidden"))})),$(window).on("load",(function(){affixHeight()})),$(document).on("click",".clickable-block:not(.js-open-as-overlay)",(function(e){if(!$(e.target).is("a")){var t=$(this).data("href");return t?(location.href=t,!1):void 0}})),$(document).on("click","a",(function(e){$(this).attr("href")&&this.hostname!=location.hostname&&"mailto:"!=$(this).attr("href").substr(0,7)&&(this.blur(),window.open(this.href),e.preventDefault())}));var e=["style1","style2","style3"];$(".posts ul li").each((function(t){$(this).addClass(e[Math.floor(Math.random()*e.length)])}))}));